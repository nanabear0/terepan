<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->
<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<div class="root">
  <app-release-type-filter></app-release-type-filter>
  <p-table
    [value]="filteredAlbums()"
    [scrollable]="true"
    scrollHeight="flex"
    [scrollable]="true"
    [virtualScroll]="useVirtualScroll()"
    [virtualScrollItemSize]="itemHeight"
    [sortField]="sortField()"
    [sortOrder]="sortOrder()"
    dataKey="id"
    size="small"
  >
    <ng-template #header>
      <tr class="nonTransparentHeader">
        <th style="width: 4rem">Cover</th>
        <th pSortableColumn="title">Title <p-sortIcon field="title" /></th>
        @if (showArtist()) {
        <th pSortableColumn="artist.name">Artist <p-sortIcon field="artist.name" /></th>
        }
        <th style="width: 8rem" pSortableColumn="firstReleaseDate">
          Date <p-sortIcon field="firstReleaseDate" />
        </th>
      </tr>
    </ng-template>
    <ng-template #body let-album>
      <tr>
        <td>
          <app-album-cover
            [id]="album.id"
            class="album-cover"
            [alt]="album.title"
          ></app-album-cover>
        </td>
        <td>
          <div class="artistCell">
            <a
              [routerLink]="['/artist', album.artist.id, 'album', album.id]"
              [skipLocationChange]="false"
              >{{ album.title }}</a
            >
            <p-tag [value]="album.primaryType" style="justify-self: end" />
            @for (secondaryType of album.secondaryTypes;track $index) {
            <p-tag [value]="secondaryType" severity="secondary" style="justify-self: end" />
            }
          </div>
        </td>
        @if (showArtist()) {
        <td>
          <a [routerLink]="['/artist', album.artist.id]">{{ album.artist.name }}</a>
        </td>
        }
        <td>{{ album.firstReleaseDate?.toLocaleDateString() }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>
